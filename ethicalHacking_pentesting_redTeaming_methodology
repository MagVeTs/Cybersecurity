Ethical Hacking = EH
Pentesting = PT
Red Teaming = RT
- terms may be used interchangeably in this doc, unless otherwise indicated
----------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

* After nmapping an IP some ports will have services that are "low hanging fruit", meaning that they are running services for which a lot of exploits exist. Others will be running services that are less likely to be easily exploitable. Focus on the "low hanging fruit" first.

http/https (80/443) - have many exploits
smb (445; smb also may use NetBIOS ports: TCP 139, TCP/UDP 137, UDP 138) - has many exploits

ssh (22) - does NOT have many exploits that are likely to grant RCE

* When working on testing http/https one of the first things to do is to visit the IP in a webbrowser.
* If visiting an IP on a webbrowser brings one to a default webpage that is a finding since it reveals info re the architecture and shows that they have open ports that they are not using (it shows poor hygiene to an attacker and encourages them to look further for misconfigurations)
* run Nikto a web app vulnerability scanner (syntax: nikto -h http://<ip_address> and  nikto -h https://<ip_address>) [Note: Nikto may be blocked if the website has a good WAF)
* attempt to perform directory busting to find accessible directories on the website:
  - there are built in tools in Kali Linux to do this:
    - dirbuster (HA's preferred directory busting tool)
    - dirb
    - gobuster
* check webpage's source code for the possible exposure of sensitive information (e.g. usernames and passwords)

* If ssh is open it is worth trying to connect even if you do not know the password, just in case a banner was left exposed that might give you exploitable information.
----------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

Reverse shells vs. bind shells
* in EH one uses reverse shells 95% of the time
* Bind shells come in handy during external PTs where the attack computer is a VM with a private IP using a NAT to present a public IP. It becomes more difficult to set the local IP for the remote host to connect back to. You would need to use the public IP and then use port forwarding. It may be easier in such circumstances to use a bind shell instead. With a bind shell your local IP does not make a difference; you just connect to the remote host IP port you have opened. Bind shells may also be needed if the firewall is blocking the reverse shell or if the reverse shell is just not working for some unknown reason.
-----------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

Staged payloads vs. non-staged payloads in Meterpreter

Staged payloads are sent to the target machine in stages. Each file that is sent is smaller and therefore less likely to fail. However, the resultant shell is sometimes unstable and liable to dropping while in use.
Non-staged payloads are sent to the target machine all at once. The one file that is sent is larger in size and sometimes fails for this reason.

Once can tell the difference between the two types in Meterpreter as follows:
windows/meterpreter_reverse_tcp - non-staged [that is why meterpreter is attached to reverse tcp with an underscore]
windows/meterpreter/reverse_tcp - staged [that is why meterpreter is divided from reverse_tcp with a forward slash; in order to show that the parts of the payload are divided up]

Note: If one is having problems with a staged payload; try the same payload non-staged (and vice versa). If one is having problem with a reverse shell; try the same exploit with a bind shell (and vice versa). Try all possible combinations.

Note: when you first run an exploit in Metasploit it may run a particular payload by default. If the exploit does not work (e.g. the shell keeps dying), use `set payload` to change to a different payload.
Also, make sure that the LHOST populated correctly.
Also, it may be worthwhile to change the local port from 4444 (the Metasploit default port) to a different port number, because AVs may be configured to alert immediately upon seeing port 4444.
------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

Post-compromise:

When checking the /etc/passwd file for users; the human users start later in the file; from ID 500 and up
------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

When attempting to brute force, dictionary attack, etc. a login first find out from the client what the lockout policy is. You do not want to lock out a company's users from access because of your pentesting activities.
------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

When doing external PT, by far the most common point-of-entry is through credential stuffing, password spraying, and default credentials. These are much more common than exploits. After OSINT and enumeration entry to an online login form can be attempted using Burp Suite and Foxy Proxy. Burp Suite (the Intruder mode) makes it easy to perform credential stuffing, etc. on the log-in page.
------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

When conducting a PT (as opposed to RT) one often is deliberately "noisy" while conducting a brute-force attack or scan in order to see whether the activity is picked up by the client's IT/NOC/SOC. If it is not picked up, that is a finding that should go in the report.
------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

* In Metasploit make sure that your payload matches the architecture of the machine you are attacking. If the default payload is an x86 intended for 32-bit machines and the machine you are trageting is a 64-bit machine make sure you change the payload to an x64.
* It is a good idea to use a meterpreter payload if possible because it provides you with a better CLI for your remote shell.\
* Meterpreter has a command `hashdump` which automatically pulls password hashes from the machine you are exploiting.
------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

Sometimes you might not actually run an exploit against a machine because it is sensitive (e.g. part of a hospital's network) and you are afraid this particular exploit might crash the machine if something goes wrong (some exploits sometimes crash machines). You might, instead, just check whether the exploit will work on the machine and take a screenshot of that info. Metasploit has auxiliary modules that will run such checks. Some manual exploits (on GitHub for instance) may also have the ability to check if the machine is unpatched and vulnerable without having to actually run the exploit.

Another option is to specifically ask the client if it is ok to run a particular exploit against a particular machine.
-------------------------
From Heath Adams - The Cyber Mentor (Practical Ethical Hacking: The Complete Course - https://academy.tcm-sec.com/courses/1152300)

On CTFs, brute-forcing or using default credentials for a secure service like SSH is usually not the route you are expected to go. However, in a real PT one does conduct such attacks in order to see if weak or default crdentials are being used; and also to see if the brute-force attempt is caught and stopped by the clent's security, as it should be.
--------------------------

